\subsection{Public auditing process} \label{sec: public auditing process}

% Public verification mechanisms are accessible to anybody. They are used to validate that the entire election process behaves correctly. This kind of mechanisms is typically run by certified auditors that will validate or invalidate an election result. Nevertheless, they could be run by any public person that has access to the right verification algorithms.

% The system provides verification mechanisms of the following aspects:
% \begin{itemize}
%     \item vote is cast as intended
%     \item vote is registered as cast
%     \item votes are counted as registered
%     \begin{itemize}
%         \item mixing procedure
%         \item decryption
%     \end{itemize}
%     \item eligibility of the registered votes
%     \item integrity of the bulletin board
% \end{itemize}

During the voting process, any public auditor is able to verify the eligibility of the registered votes (i.e. all vote submissions were generated by a genuine voter) and the integrity of the bulletin board (i.e. no registered vote submissions have been removed or tampered with).
 
After the voting phase has finished and the integrity of the election has been confirmed, the \textit{Digital Ballot Box} $\mathcal{D}$ goes through the cleansing procedure, where some of the vote submissions are filtered out based on some public rules. For each of the remaining vote submissions, the system will consider only its vote cryptogram which will be passed to the following counting process. The rules of the cleansing procedure are the following:
\begin{itemize}
    \item only vote submissions with valid digital signatures are considered
    \item for each voter, only his last vote submission is considered 
    \item if a voter has been removed, all his vote submissions are disregarded
\end{itemize}
 
During the counting process, any public auditor is able to verify that the result is counted based on the registered votes. This verification process is made out of two parts: verification of the mixing procedure (i.e. confirm that vote cryptograms have not been tampered with during the mixing phase) and verification of the decryption process (i.e. confirm that all trustees correctly decrypted the vote cryptograms).

All public auditing processes are based on the data provided by the \textit{Digital Ballot Box} $\mathcal{D}$, which includes:
\begin{itemize}
    \item all registered vote submissions, each represented by the following data: the voter id $i$, the vote cryptogram $e$, the acknowledged hash $h_\mathrm{a}$, the acknowledged time stamp $t_\mathrm{a}$, the voter digital signature $\sigma$, the board hash $h_\mathrm{b}$ and the registration time stamp $t_\mathrm{r}$
    \item all the election configuration, including the election id $eID$, the election encryption key $Y_\mathrm{enc}$ and signature verification key $Y_\mathrm{sig}$ and the signature verification keys of all eligible voters $Y_i$, with \( i \in \{ 1, ..., n_\mathrm{v} \} \), where $n_\mathrm{v}$ is the total number of voters
    \item all the data regarding the threshold ceremony, including the threshold limit $t$, the public keys of all trustees $Y_j$ and the public threshold coefficients $P_{j, k}$, where \( j \in \{ 1, ..., n_\mathrm{t} \} \) and \( k \in \{ 1, ..., t-1 \} \)
\end{itemize}

 
\subsubsection{Eligibility verifiability}
Any public auditor is able to validate the digital signature of each vote submission. A valid digital signature confirms that the vote submission has been genuinely generated by an eligible voter. The signature validation algorithm is \( \mathsf{SigVer} (Y_i, \sigma, h_\mathrm{v}) \) (\cref{alg: sig ver}), where \( h_\mathrm{v} = \mathcal{H}( i || eID || e || t_\mathrm{a} || h_\mathrm{a}) \).

Note that through his digital signature, the voter also certifies the history of the bulletin board (i.e. at time $t_\mathrm{a}$ the board hash value was $h_\mathrm{a}$).


\subsubsection{Integrity of the bulletin board}
Any public auditor is able to validate the integrity of the bulletin board by checking that the board hash of each item on the board is computed based on the previous board hash, in a blockchain manner. The calculation below include an extra index $j$ to specify the order of the entries from the bulletin board. To validate the integrity of the board, for each \( j \in \{ 1, ..., n_\mathrm{b} \} \), where $n_\mathrm{b}$ is the total number of items on the bulletin board, the following has to match: \( h_{\mathrm{b},j} = \mathcal{H}(h_{\mathrm{v},j} || h_{\mathrm{b},j-1} || t_{\mathrm{r},j}) \).

Note that each board hash $h_{\mathrm{b},j}$ is computed based on its previous board hash $h_{\mathrm{b},j-1}$. The value of the initial board hash is \( h_{\mathrm{b},0} = 0 \).


\subsubsection{Verification of the cleansing procedure}
Any public auditor is able to verify the cleansing procedure as both the bulletin board file and the cleansed list of vote cryptograms are publicly available. The auditor has to apply the cleansing rules on the bulletin board and verify that the output is identical with the list of vote cryptograms.


\subsubsection{Verification of mixing procedure}
During and after the mixing phase, any public auditor is able to verify the mixing procedure of each trustee $\mathcal{T}_i$ with $i \in \tau$, where $\tau$ is the subset of trustees that participated in the mixing phase. The mixing verification algoroithm is \( \mathbf{VerifyShuffle}_{Y_\mathrm{enc}} (PK_i, \boldsymbol{e_{i-1}}, \boldsymbol{e_i}) \) (\cref{alg: ver askc}), where $PK_i$ is the proof of correct mixing, $\boldsymbol{e_i}$ is the mixed board of cryptograms and $\boldsymbol{e_{i-1}}$ is the previous mixed board of cryptograms.

Note that $\boldsymbol{e_0} = \{ e_1, ..., e_{n_\mathrm{e}} \}$ is the initial, \textbf{cleansed} board of vote cryptograms as registered by the voters, where $n_\mathrm{e}$ is the total number of cryptograms. 


\subsubsection{Verification of the decryption}
During and after the decryption phase, any public auditor is able to verify each partial decryption \( \boldsymbol{S_i} = \{ S_{i,1}, ..., S_{i,n_\mathrm{cb}} \} \) computed by the trustee $\mathcal{T}_i$, with \( i \in \{ 1, ..., n_\mathrm{t} \} \), where $n_\mathrm{t}$ is the total number of trustees. 

Note that each trustee applies his partial decryption on the final mixed board of cryptograms \( \boldsymbol{e_{n_\mathrm{m}}} = \{ e_1, ..., e_{n_\mathrm{cb}} \} \) (the board outputted by the last mix node), with each \( e_j = (R_j, C_j) \), where \( j \in \{ 1, ..., n_\mathrm{cb} \} \).

To validate a partial decryption, the auditor has to run the verification procedure $\mathsf{DLVer} (PK_i, \{ G, R_1, ..., R_{n_\mathrm{cb}} \}, \{ sY_i, S_{i,1}, ..., S_{i,n_\mathrm{cb}} \})$ (\cref{alg: dl ver}), where $PK_i$ is the proof of correct decryption and $sY_i$ is the trustee's public share of the decryption key. Note that $sY_i$ is publicly computable as described in \cref{sec: threshold ceremony}.

To validate the aggregation of all partial decryptions \( \{\boldsymbol{S_1}, ..., \boldsymbol{S_{n_\mathrm{d}}}\} \), where $n_\mathrm{d}$ is the total number of trustees that participate in the decryption phase, any public auditor can run the algorithm \( \boldsymbol{V} \leftarrow \mathbf{FinalizeDecryption} (\boldsymbol{e_{n_\mathrm{m}}}, \boldsymbol{S_1}, ..., \boldsymbol{S_{n_\mathrm{d}}}) \) (\cref{alg: finalize decryption}) that will output \( \boldsymbol{V} = \{ V_1, ..., V_{n_\mathrm{cb}} \} \), the raw result of the election (i.e. the list of decrypted votes). The auditor has to compare $\boldsymbol{V}$ with the list of votes published by the system, which should be identical.

Counting the votes and sorting the candidates based on their vote count is trivial.
