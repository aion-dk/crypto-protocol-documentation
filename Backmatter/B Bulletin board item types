\section{Bulletin board item types} \label{app: bulletin board item types}

All item types are described in the following list and are grouped in the following 3 categories:

\paragraph{Configuration items}
\begin{enumerate}
    \item 
        The \textit{genesis} is the initial item of the bulletin board and it describes some metadata of the election. Basically, this is the item that spawns a new bulletin board. The structure of it consists of the \textbf{metadata} and the following attributes:
        \begin{itemize}
            \item the elliptic curve domain parameters $(p, a, b, G, q, h)$,
            \item the public key of the \textit{Digital Ballot Box} $Y_\mathcal{D}$,
            \item the URL of the bulletin board,
            \item the voter authorization mode.
        \end{itemize}
        The following rules apply to the \textit{genesis} item:
        \begin{itemize}
            \item It is written by the \textit{Digital Ballot Box} $\mathcal{D}$.
            \item It has no \textit{parent}.
            \item The \textit{genesis} item is the first item of the board.
            \item There is one single \textit{genesis} item on the entire bulletin board (i.e. the data in the \textit{genesis} item does not support updates). 
        \end{itemize}
    \item
        The \textit{election configuration} is an item specifying some configuration on election level. The structure of it consists of the \textbf{metadata} and the following attributes:
        \begin{itemize}
            \item the public key of the \textit{Election Administrator} $Y_\mathcal{E}$,
            \item the start and end time of the election.
        \end{itemize}
        The following rules apply to the \textit{election configuration} item:
        \begin{itemize}
            \item It is written by the \textit{Election Administrator} $\mathcal{E}$.
            \item It has as \textit{parent} the previous configuration item.
            \item The first \textit{election configuration} item defines the initial configuration of the election.
            \item The following \textit{election configuration} items define updates that are made to the election configuration.
            \item \textcolor{orange}{How does an update affect a running election?}
        \end{itemize}
    
    \item 
        The \textit{contest configuration} is an item defining the configuration of a contest. The structure of it consists of the \textbf{metadata} and the following attributes:
        \begin{itemize}
            \item a unique identifier of the contest,
            \item the marking rules of the contest,
            \item the question type of the contest,
            \item the list of candidates with their unique labels $\{m_1, ..., m_{n_\mathrm{c}}\}$, where $n_\mathrm{c}$ is the number of candidates,
            \item the result rules of the contest.
        \end{itemize}
        The following rules apply to the \textit{contest configuration} item:
        \begin{itemize}
            \item It is written by the \textit{Election Administrator} $\mathcal{E}$.
            \item It has as \textit{parent} the previous configuration item.
            \item The first \textit{contest configuration} item with a specific contest identifier defines the initial configuration of that contest.
            \item The following \textit{contest configuration} items with a specific contest identifier define updates that are made to that contest configuration.
            \item \textcolor{orange}{What attributes are allowed to be updated?}
            \item \textcolor{orange}{How does an update affect a running election?}
        \end{itemize}
        
    \item 
        The \textit{threshold configuration} is the item defining the ballot encryption key and all data relevant to the threshold ceremony. The structure of it consists of the \textbf{metadata} and the following attributes:
        \begin{itemize}
            \item the encryption key $Y_\mathrm{enc}$,
            \item the threshold setup $t$-out-of-$n_\mathrm{t}$, where $t$ is the amount of trustees needed for decryption and $n_\mathrm{t}$ is the total number of trustees,
            \item the list of trustees, each defined by its public key $Y_{\mathcal{T}_i}$ and the list of public polynomial coefficients $\{P_{\mathcal{T}_i,1}, ..., P_{\mathcal{T}_i,t-1}\}$. This data is relevant for auditing purpose.
        \end{itemize}
        The following rules apply to the \textit{threshold configuration} item:
            \begin{itemize}
                \item It is written by the \textit{Election Administrator} $\mathcal{E}$.
                \item It has as \textit{parent} the previous configuration item.
                \item There is one single \textit{threshold configuration} item on the entire bulletin board (i.e. the threshold configuration does not support updates).
            \end{itemize}
    
    \item 
        The \textit{voters configuration} is the item defining all eligible voters in the election. This item is present when the voter registration mode is \textbf{pre-election}. The structure of it consists of the \textbf{metadata}, and a list of all voters each defined by the following attributes:
        \begin{itemize}
            \item a unique identifier $vID_i$,
            \item the public key $Y_i$,
            \item a flag defining whether the voter is enabled or not. \textcolor{orange}{This is so the election administrators is able to disable a voter if necessary. This information is public to maintain end to end verifiability.}
        \end{itemize}
        The following rules apply to the \textit{voters configuration} item:
        \begin{itemize}
            \item It is written by the \textit{Election Administrator} $\mathcal{E}$.
            \item It has as \textit{parent} the previous configuration item.
            \item There is one single \textit{voters configuration} item on the entire bulletin board.
        \end{itemize}
    
    \item
        The \textit{voter configuration} is an item that describes a change in the list of voters. It can be used either to add a new voter or to update an existing voter. This item can be present when the voter registration mode is \textbf{pre-election}. The structure of it consists of the \textbf{metadata} and the following attributes:
        \begin{itemize}
            \item the voter identifier $vID_i$,
            \item the public key $Y_i$,
            \item the enabled flag. \textcolor{orange}{This is so the election administrators is able to disable a voter if necessary. This information is public to maintain end to end verifiability.}
        \end{itemize}
        The following rules apply to the \textit{voter configuration} item:
        \begin{itemize}
            \item It is written by the \textit{Election Administrator} $\mathcal{E}$.
            \item It has as \textit{parent} the previous configuration item.
            \item If the voter identifier $vID$ has been previously defined on the bulletin board, then this item updates that voter's configuration.
            \item Otherwise, this item defines a new eligible voter.
            \item \textcolor{orange}{What attributes of a voter can be changed?}
            \item \textcolor{orange}{What if a voter is disabled after having voted?}
        \end{itemize}
    
    \item
        The \textit{voter authorization configuration} is the item describing the configuration of the \textit{Voter Authorizer} $\mathcal{A}$ and \textit{Identity Providers} $\{\mathcal{I}_1, ..., \mathcal{I}_{n_\mathrm{i}}\}$, where $n_\mathrm{i}$ is the number of providers. This item is present when the voter registration mode is \textbf{on-demand}. The structure of it consists of the \textbf{metadata} and the following attributes:
        \begin{itemize}
            \item the public key of the \textit{Voter Authorizer} $Y_\mathcal{A}$,
            \item a list that contains all \textit{Identity Providers} defined by their public keys $\{Y_{\mathcal{I}_1}, ..., Y_{\mathcal{I}_{n_\mathrm{i}}}\}$.
        \end{itemize}
        The following rules apply to the \textit{voter authorization configuration} item:
        \begin{itemize}
            \item It is written by the \textit{Election Administrator} $\mathcal{E}$.
            \item It has as \textit{parent} the previous configuration item.
            \item The first \textit{voter authorization configuration} item defines the initial configuration of the \textit{Voter Authorizer} and the \textit{Identity Providers}.
            \item The following \textit{voter authorization configuration} items define updates that are made to the configuration of the \textit{Voter Authorizer} or the \textit{Identity Providers}.
            \item \textcolor{orange}{How does an update affect a running election?}
            \item \textcolor{orange}{How does an update affect a currently open voting session authorized by the old configuration of the \textit{Voter Authorizer}?}
        \end{itemize}
\end{enumerate}

\paragraph{Voting items}
\begin{enumerate}
    \setcounter{enumi}{7}
    \item
        The \textit{voter session} is the item that documents the fact that a new voter has been authorized to cast a vote. This item is present when the voter registration mode is \textbf{on-demand}. The structure of it consists of the \textbf{metadata} and the following voter attributes:
        \begin{itemize}
            \item the voter identifier $vID_i$,
            \item the public key of the \textit{Voter} $Y_i$,
            \item the authorization token $\sigma_{\mathrm{auth}, i}$ (see \cref{sec: voter authentication procedure} for details) generated by the \textit{Voter Authorization} $\mathcal{A}$.
        \end{itemize}
        The following rules apply to the \textit{voter authorization configuration} item:
        \begin{itemize}
            \item It is written by the \textit{Digital Ballot Box} $\mathcal{D}$.
            \item It has as \textit{parent} the previous configuration item.
            \item A new item is generated whenever a voter is authorized to vote.
            \item \textcolor{orange}{What if a voter needs to be disabled?}
        \end{itemize}
    
    \item 
        The \textit{voter encryption commitment} is the item that secretly defines the encryption parameters chosen by the \textit{Voter}. The structure of it consists of the \textbf{metadata} and the commitment values $C$ to all cryptogram randomizers chosen by the \textit{Voter}. The following rules apply to the \textit{voter encryption commitment} item:
        \begin{itemize} 
            \item It is written by the \textit{Voter} $\mathcal{V}_i$.
            \item It has as \textit{parent} the \textit{voter session} item .
            \item A new item is generated whenever the \textit{Voter} encrypts a new ballot.
        \end{itemize}
    
    \item
        The \textit{server encryption commitment} is the item that secretly defines the encryption parameters chosen by the \textit{Digital Ballot Box}. It is generated as a response to the \textit{voter encryption commitment} being posted. The structure of it consists of the \textbf{metadata} and the commitment values $C$ to all cryptogram randomizers chosen by the \textit{Digital Ballot Box}. The following rules apply to the \textit{server encryption commitment} item:
        \begin{itemize}
            \item It is written by the \textit{Digital Ballot Box} $\mathcal{D}$.
            \item It has as \textit{parent} the \textit{voter encryption commitment} item.
            \item A new item is generated whenever a \textit{voter encryption commitment} is published.
        \end{itemize}
    
    \item
        The \textit{ballot cryptograms} is the item that contains the encrypted digital ballot. The structure of it consists of the \textbf{metadata} and the cryptograms that the ballot is made out of. The following rules apply to the \textit{ballot cryptograms} item:
        \begin{itemize}
            \item It is written by the \textit{Voter} $\mathcal{V}_i$.
            \item It has as \textit{parent} the \textit{server encryption commitment} item.
            \item A new item is generated whenever the \textit{Voter} submits a new encrypted digital ballot.
        \end{itemize}
    
    \item
        The \textit{cast request} is the item that documents the action of casting a previously submitted ballot. The structure of it consists only of \textbf{metadata}. The following rules apply to the \textit{cast request} item:
        \begin{itemize}
            \item It is written by the \textit{Voter} $\mathcal{V}_i$.
            \item It has as \textit{parent} the \textit{ballot cryptograms} item.
            \item A new item is generated whenever the \textit{Voter} chooses to cast a ballot.
        \end{itemize}
    
    \item
        The \textit{spoil request} is the item that documents the action of spoiling (or challenge the encryption of) a previously submitted ballot. The structure of it consists only of \textbf{metadata}. The following rules apply to the \textit{spoil request} item:
        \begin{itemize}
            \item It is written by the \textit{Voter} $\mathcal{V}_i$.
            \item It has as \textit{parent} the \textit{ballot cryptograms} item.
            \item A new item is generated whenever the \textit{Voter} chooses to spoil a ballot.
        \end{itemize}
\end{enumerate}

\paragraph{Hidden items}
\begin{enumerate}
    \setcounter{enumi}{13}
    \item
        The \textit{verification track start} is the initial item of the hidden verification track. It, basically, spawns the verification track of each ballot cryptogram. It is generated as a response to the \textit{ballot cryptograms} item being posted.  The structure of it consists only of \textbf{metadata}. The following rules apply to the \textit{verification track start} item:
        \begin{itemize}
            \item It is written by the \textit{Digital Ballot Box} $\mathcal{D}$.
            \item It has as \textit{parent} the \textit{ballot cryptograms} item.
            \item It is appended on the hidden verification track.
            \item A new item is generated whenever a new \textit{ballot cryptograms} item is appended on the bulletin board.
        \end{itemize}
    
    \item
        The \textit{verifier} is the item that defines the details of the \textit{External Verifier} $\mathcal{X}$. The structure of it consists of the \textbf{metadata} and the public key of the \textit{External Verifier} $Y_\mathcal{X}$. The following rules apply to the \textit{verifier} item:
        \begin{itemize}
            \item It is written by the \textit{External Verifier} $\mathcal{X}$.
            \item It has as \textit{parent} the \textit{verification track start} item.
            \item It is appended on the hidden verification track.
            \item A new item is generated whenever an \textit{External Verifier} is used to challenge a vote cryptogram.
        \end{itemize}
    
    \item
        The \textit{voter commitment opening} is the item that contain a part of the data (voter side) necessary for unpacking the spoiled encrypted ballot. This data is encrypted itself, such that only the \textit{External Verifier} can read it. The structure of it consists of the \textbf{metadata} and the encrypted data blob of the openings of the \textit{Voter's} commitment from the \textit{voter encryption commitment} item. The following rules apply to the \textit{voter commitment opening} item:
        \begin{itemize}
            \item It is written by the \textit{Voter} $\mathcal{V}_i$.
            \item It has as \textit{parent} the \textit{verifier} item.
            \item It is appended on the hidden verification track.
            \item A new item is generated whenever the \textit{Voter} chooses to challenge the vote cryptograms and confirms the collaboration with the \textit{External Verifier}.
        \end{itemize}
    
    \item
        The \textit{server commitment opening} is the item that contain the second part of the data (server side) necessary for unpacking the spoiled encrypted ballot. This data is encrypted itself, such that only the \textit{External Verifier} can read it. This item is generated as a response to the \textit{voter commitment opening} item being posted.The structure of it consists of the \textbf{metadata} and the encrypted data blob of the openings of the commitment of the \textit{Digital Ballot Box} from the \textit{server encryption commitment} item. The following rules apply to the \textit{server commitment opening} item:
        \begin{itemize}
            \item It is written by the \textit{Digital Ballot Box} $\mathcal{D}$.
            \item It has as \textit{parent} the \textit{voter commitment opening} item.
            \item It is appended on the hidden verification track.
            \item A new item is generated whenever the \textit{Voter} chooses to challenge the vote cryptograms and confirms the collaboration with the \textit{External Verifier}.
        \end{itemize}
\end{enumerate}